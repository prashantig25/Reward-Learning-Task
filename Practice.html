<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Practice</title>
    <script src="js/jspsych.js"></script>
    <script src="js/additionals.js"></script>
    <script src="js/custom.css"></script>
    <script src="js/jspsych-canvas-slider-response.js"></script>
    <script src="js/jspsych-html-keyboard-response.js"></script>
    <script src="js/jspsych-canvas-keyboard-response.js"></script>
    <link href="js/jspsych.css" rel="stylesheet" type="text/css"/>
</head>
<style>
    body {
        background-color: #808080;
    }
</style>
<script>
var timeline = [];
var fix = {
        type: 'canvas-keyboard-response',
        stimulus: fixation,
        trial_duration: fix_dura,
        choices: jsPsych.NO_KEYS,
        data: { condition: 'fixation'},
        on_start: function () {
          document.body.style.cursor = "none";
        }
    };

var prac_block = {
        type: "html-keyboard-response", stimulus: "<p style=\"font-size: 20px;color: #000000\"> A practice block will begin now. Press any key to start the practice block.</p>",
    };
var prac_score = {
        type: 'html-keyboard-response',
        on_start: function(score){
            score.total = jsPsych.data.get().last(125).select('correct').sum()
        },
        stimulus:function () {
            var prac_counter = prac_blocks.shift()
            var points = jsPsych.data.get().last(125).select('correct').sum() // adds all the points earned in the last n (trialcounter) number of trials to present total points at the end of the block.
            return `<p style=\"font-size: 25px;color: #000000\">You win <strong> ${points} </strong> points in this block. <br> You have completed <strong> ${prac_counter} </strong> blocks out of 3 blocks of the practice task. Press a key to proceed forward.</p>`
        },
        on_finish: function(data) {
            data.finalscore = jsPsych.currentTrial().total // final score after each block
            //trialcounter = 0 // trial counter resets to 0 after a block ends because the trialcounter counts the number of points in each block seperately
            index = 0 // index of rewards also resets to 0 after a block ends
            index_missed = 0
            index_mu = 0
            action_s0 = 0;
            action_s1 = 0;
            s = shuffle(state);
            s_mu = shuffle(state_mu);
        }
    }; 
var fb = {
        type: "html-keyboard-response", choices: jsPsych.NO_KEYS, trial_duration: duration,
        stimulus: function () {
            var last_trial_correct = jsPsych.data.get().last(1).values()[0].correct;
            if (last_trial_correct) {
                return "<p style=\"font-size: 30px;color: #016901; position: fixed; top: 45%; left: 42%;\">You win 1 point!</p>";
            } else {
                return "<p style=\"font-size: 30px;color: #ba0000; position: fixed; top: 45%; left: 42%;\">You win 0 points!</p>"
            }
        },
        on_finish: function(data) {
          //data.prompt_patch = shuffled_patch.pop()
          data.index = index_mu // index starts at 0
          var blocktype = jsPsych.data.get().last(2).values()[0].block
          if ( blocktype === 1 || blocktype === 2) {
            if (s_mu[data.index] === 0) { // state that the trial belongs to
                data.difference = randbet(high_min_neg, high_max_neg) // contrast differences for s = 0
            }
            else {
                data.difference = randbet(high_min, high_max)
            }
          }
          else {
              if (s_mu[data.index] === 0) { // state that the trial belongs to
                data.difference = randbet(low_min_neg, low_max_neg) // contrast differences for s = 0
              }
              else {
                data.difference = randbet(low_min, low_max)
              }
            }
          
          data.contrast_left = avgcon + data.difference // calculate the contrast for the left gabor based on this trial's difference
          data.contrast_right  = avgcon - data.difference
        }
    };
var nextblock = {
        type: "html-keyboard-response",
        stimulus: "<p style=\"font-size: 20px;color: #000000\"> Next block begins now. <br> The relationship between the contrast level of the images and reward may change now as compared to previous blocks. <br> Press a key when you are ready.</p>",
    };
var prac_rand = jsPsych.randomization.sampleWithReplacement([0,1,2,3],1);


var perceptual = {
        type: 'canvas-keyboard-response',
        stimulus: gabor, // generates the two patches for the trial using the gabor function
        data: {condition: 'perceptual_lc'}, // data stored for this trial
        choices: keys, response_ends_trial: false, trial_duration: duration,
        on_start: function(perceptual){
            document.body.style.cursor = "none";
            perceptual.index = index // index starts at 0
            if (s[jsPsych.currentTrial().index] === 0) { // state that the trial belongs to
                perceptual.action_s0 = action_s0
                perceptual.difference = randbet(high_min_neg, high_max_neg) // contrast differences for s = 0
                perceptual.reward = actionleft_100[jsPsych.currentTrial().action_s0] // picks the correct key press for this trial by serially sampling throug the list using action_s0
                perceptual.a = 0 // reward state i.e. of a = 0, then arrowleft is more profitable and it is vice versa, if a = 1
                action_s0 = action_s0 + 1; // increase the action_s0 by 1 to pick the next element from the action list for the next trial
            }
            else {
                perceptual.action_s1 = action_s1
                perceptual.difference = randbet(high_min, high_max)
                perceptual.reward = actionright_100[jsPsych.currentTrial().action_s1]
                perceptual.a = 1
                action_s1 = action_s1 + 1;
            }
            perceptual.contrast_left = avgcon + jsPsych.currentTrial().difference // calculate the contrast for the left gabor based on this trial's difference
            perceptual.contrast_right = avgcon - jsPsych.currentTrial().difference // calculate the contrast for the right gabor based on this trial's difference
        },
        on_finish: function (data) {
            data.block = 1 // 1 = perceptual, 2 = mixed, 3 = reward
            data.contrast = 0 // 0 = low contrast, 1 = high contrast
            if (data.response === jsPsych.currentTrial().reward) { // if the participant's key press is the same as the correct key_press
                data.correct = true;
                data.stim = 0; // keeps the stim value at 0 because the participant has not missed a trial
            } else if (data.response === null) { // if the participant does not respond to a particular trial
                missed.push(1),
                    missed_fb.push(jsPsych.currentTrial().reward),  // add this trial's correct response to the missed_fb array so that it can be repeated with the missed trial
                    missed_con.push(jsPsych.currentTrial().contrast_left), // add this trial's left contrast to the missed_con array so that it can be repeated with the missed trial
                    missed_con1.push(jsPsych.currentTrial().contrast_right) // add this trial's right contrast to the missed_con1 array so that it can be repeated with the missed trial
                missed_block.push(data.block)
                missed_contrast.push(data.contrast)
            } else { // if the participant's key_press is not the same as correct key_press
                data.correct = false;
                data.stim = 0; // keeps the stim value at 0 because the participant has not missed a trial
            }
            data.block = 1 // 1 = perceptual, 2 = mixed, 3 = reward
            data.corr_resp = jsPsych.currentTrial().reward // stores the correct response on this trial
            data.contrast_left = jsPsych.currentTrial().contrast_left // stores the contrast level of left patch on this trial
            data.contrast_right = jsPsych.currentTrial().contrast_right // stores the contrast level of right patch on this trial
            data.diff = jsPsych.currentTrial().difference
            trialcounter = trialcounter + 5 // increases the trial counter to include fixation, stimulus and feedback
            index = index + 1; // increase the index by 1 so that the next trial, the next state can be chosen from the state array
            data.state = s[jsPsych.currentTrial().index] // store the state of the trial
            data.reward = jsPsych.currentTrial().a // store the action for this trial
        }
    };
var perceptual_1 = {
        type: 'canvas-keyboard-response',
        stimulus: gabor, // generates the two patches for the trial using the gabor function
        data: {condition: 'perceptual_hc'}, // data stored for this trial
        choices: keys, response_ends_trial: false, trial_duration: duration,
        on_start: function(perceptual_1){
            document.body.style.cursor = "none";
            perceptual_1.index = index // index starts at 0
            if (s[jsPsych.currentTrial().index] === 0) {
                perceptual_1.action_s0 = action_s0
                perceptual_1.difference = randbet(high_min_neg, high_max_neg)
                perceptual_1.reward = actionright_100[jsPsych.currentTrial().action_s0]
                perceptual_1.a = 1
                action_s0 = action_s0 + 1;
            }
            else {
                perceptual_1.action_s1 = action_s1
                perceptual_1.difference = randbet(high_min, high_max)
                perceptual_1.reward = actionleft_100[jsPsych.currentTrial().action_s1]
                perceptual_1.a = 0
                action_s1 = action_s1 + 1;
            }
            perceptual_1.contrast_left = avgcon + jsPsych.currentTrial().difference
            perceptual_1.contrast_right = avgcon - jsPsych.currentTrial().difference
            
        },
        on_finish: function (data) {
            data.block = 1
            if (data.response === jsPsych.currentTrial().reward) {
                data.correct = true;
                data.stim = 0;
            } else if (data.response === null) {
                missed.push(1),
                    missed_fb.push(jsPsych.currentTrial().reward),
                    missed_con.push(jsPsych.currentTrial().contrast_left),
                    missed_con1.push(jsPsych.currentTrial().contrast_right)
                    missed_block.push(data.block)
                    missed_contrast.push(data.contrast)
            } else {
                data.correct = false;
                data.stim = 0; // keeps the stim value at 0 because the participant has not missed a trial
            }
            data.block = 1 
            data.contrast = 1 // 0 = low contrast, 1 = high contrast 
            data.corr_resp = jsPsych.currentTrial().reward // stores the correct response on this trial
            data.contrast_left = jsPsych.currentTrial().contrast_left // stores the contrast level of left patch on this trial
            data.contrast_right = jsPsych.currentTrial().contrast_right // stores the contrast level of right patch on this trial
            data.diff = jsPsych.currentTrial().difference
            trialcounter = trialcounter + 5 // increases the trial counter to include fixation, stimulus and feedback
            index = index + 1;
            data.state = s[jsPsych.currentTrial().index]
            data.reward = jsPsych.currentTrial().a
        }
    };
var reward = {
        type: 'canvas-keyboard-response',
        stimulus: gabor, // generates the two patches for the trial using the gabor function
        data: {condition: 'reward_lc'}, // data stored for this trial
        choices: keys, response_ends_trial: false, trial_duration: duration,
        on_start: function(reward){
            document.body.style.cursor = "none";
            reward.index = index // index starts at 0
            if (s[jsPsych.currentTrial().index] === 0) {
                reward.action_s0 = action_s0
                reward.difference = randbet(low_min_neg, low_max_neg)
                reward.reward = actionleft_70[jsPsych.currentTrial().action_s0]
                reward.a = 0
                action_s0 = action_s0 + 1;
            }
            else {
                reward.action_s1 = action_s1
                reward.difference = randbet(low_min, low_max)
                reward.reward = actionright_70[jsPsych.currentTrial().action_s1]
                reward.a = 1
                action_s1 = action_s1 + 1;
            }
            reward.contrast_left = avgcon + jsPsych.currentTrial().difference
            reward.contrast_right = avgcon - jsPsych.currentTrial().difference
          
        },
        on_finish: function (data) {
            data.block = 3
            if (data.response === jsPsych.currentTrial().reward) {
                data.correct = true;
                data.stim = 0;
            } else if (data.response === null) {
                missed.push(1),
                    missed_fb.push(jsPsych.currentTrial().reward),
                    missed_con.push(jsPsych.currentTrial().contrast_left),
                    missed_con1.push(jsPsych.currentTrial().contrast_right)
                    missed_block.push(data.block)
                    missed_contrast.push(data.contrast)
            } else {
                data.correct = false;
                data.stim = 0; // keeps the stim value at 0 because the participant has not missed a trial
            }
            data.contrast = 0;
            data.corr_resp = jsPsych.currentTrial().reward // stores the correct response on this trial
            data.contrast_left = jsPsych.currentTrial().contrast_left // stores the contrast level of left patch on this trial
            data.contrast_right = jsPsych.currentTrial().contrast_right // stores the contrast level of right patch on this trial
            data.diff = jsPsych.currentTrial().difference
            trialcounter = trialcounter + 5 // increases the trial counter to include fixation, stimulus and feedback
            index = index + 1;
            data.state = s[jsPsych.currentTrial().index]
            data.reward = jsPsych.currentTrial().a
        }
    };
var reward_1 = {
        type: 'canvas-keyboard-response',
        stimulus: gabor, // generates the two patches for the trial using the gabor function
        data: {condition: 'reward_hc'}, // data stored for this trial
        choices: keys, response_ends_trial: false, trial_duration: duration,
        on_start: function(reward_1){
            document.body.style.cursor = "none";
            reward_1.index = index // index starts at 0
            if (s[jsPsych.currentTrial().index] === 0) {
                reward_1.action_s0 = action_s0
                reward_1.difference = randbet(low_min_neg, low_max_neg)
                reward_1.reward = actionright_70[jsPsych.currentTrial().action_s0]
                reward_1.a = 1
                action_s0 = action_s0 + 1;
            }
            else {
                reward_1.action_s1 = action_s1
                reward_1.difference = randbet(low_min, low_max)
                reward_1.reward = actionleft_70[jsPsych.currentTrial().action_s1]
                reward_1.a = 0
                action_s1 = action_s1 + 1;
            }
            reward_1.contrast_left = avgcon + jsPsych.currentTrial().difference
            reward_1.contrast_right = avgcon - jsPsych.currentTrial().difference
            
        },
        on_finish: function (data) {
            data.block = 3
            if (data.response === jsPsych.currentTrial().reward) {
                data.correct = true;
                data.stim = 0;
            } else if (data.response === null) {
                missed.push(1),
                    missed_fb.push(jsPsych.currentTrial().reward),
                    missed_con.push(jsPsych.currentTrial().contrast_left),
                    missed_con1.push(jsPsych.currentTrial().contrast_right)
                    missed_block.push(data.block)
                    missed_contrast.push(data.contrast)
            } else {
                data.correct = false;
                data.stim = 0; // keeps the stim value at 0 because the participant has not missed a trial
            }
            data.contrast = 1;
            data.corr_resp = jsPsych.currentTrial().reward // stores the correct response on this trial
            data.contrast_left = jsPsych.currentTrial().contrast_left // stores the contrast level of left patch on this trial
            data.contrast_right = jsPsych.currentTrial().contrast_right // stores the contrast level of right patch on this trial
            data.diff = jsPsych.currentTrial().difference
            trialcounter = trialcounter + 5 // increases the trial counter to include fixation, stimulus and feedback
            index = index + 1;
            data.state = s[jsPsych.currentTrial().index]
            data.reward = jsPsych.currentTrial().a
        }
    };
var mixed = {
        type: 'canvas-keyboard-response',
        stimulus: gabor, // generates the two patches for the trial using the gabor function
        data: {condition: 'mixed_lc'}, // data stored for this trial
        choices: keys, response_ends_trial: false, trial_duration: duration,
        on_start: function(mixed){
            document.body.style.cursor = "none";
            mixed.index = index // index starts at 0
            if (s[jsPsych.currentTrial().index] === 0) {
                mixed.action_s0 = action_s0
                mixed.difference = randbet(high_min_neg, high_max_neg)
                mixed.reward = actionleft_70[jsPsych.currentTrial().action_s0]
                mixed.a = 0
                action_s0 = action_s0 + 1;
            }
            else {
                mixed.action_s1 = action_s1
                mixed.difference = randbet(high_min, high_max)
                mixed.reward = actionright_70[jsPsych.currentTrial().action_s1]
                mixed.a = 1
                action_s1 = action_s1 + 1;
            }
            mixed.contrast_left = avgcon + jsPsych.currentTrial().difference
            mixed.contrast_right = avgcon - jsPsych.currentTrial().difference
            
        },
        on_finish: function (data) {
          data.block = 2
            if (data.response === jsPsych.currentTrial().reward) {
                data.correct = true;
                data.stim = 0;
            } else if (data.response === null) {
                missed.push(1),
                    missed_fb.push(jsPsych.currentTrial().reward),
                    missed_con.push(jsPsych.currentTrial().contrast_left),
                    missed_con1.push(jsPsych.currentTrial().contrast_right)
                    missed_block.push(data.block)
                    missed_contrast.push(data.contrast)
            } else {
                data.correct = false;
                data.stim = 0; // keeps the stim value at 0 because the participant has not missed a trial
            }
            data.contrast = 0;
            data.corr_resp = jsPsych.currentTrial().reward // stores the correct response on this trial
            data.contrast_left = jsPsych.currentTrial().contrast_left // stores the contrast level of left patch on this trial
            data.contrast_right = jsPsych.currentTrial().contrast_right // stores the contrast level of right patch on this trial
            data.diff = jsPsych.currentTrial().difference
            trialcounter = trialcounter + 5 // increases the trial counter to include fixation, stimulus and feedback
            index = index + 1;
            data.state = s[jsPsych.currentTrial().index]
            data.reward = jsPsych.currentTrial().a
        }
    };
var mixed_1 = {
        type: 'canvas-keyboard-response',
        stimulus: gabor, // generates the two patches for the trial using the gabor function
        data: {condition: 'mixed_hc'}, // data stored for this trial
        choices: keys, response_ends_trial: false, trial_duration: duration,
        on_start: function(mixed_1){
            document.body.style.cursor = "none";
            mixed_1.index = index // index starts at 0
            if (s[jsPsych.currentTrial().index] === 0) {
                mixed_1.action_s0 = action_s0
                mixed_1.difference = randbet(high_min_neg, high_max_neg)
                mixed_1.reward = actionright_70[jsPsych.currentTrial().action_s0]
                mixed_1.a = 1
                action_s0 = action_s0 + 1;
            }
            else {
                mixed_1.action_s1 = action_s1
                mixed_1.difference = randbet(high_min, high_max)
                mixed_1.reward = actionleft_70[jsPsych.currentTrial().action_s1]
                mixed_1.a = 0
                action_s1 = action_s1 + 1;
            }
            mixed_1.contrast_left = avgcon + jsPsych.currentTrial().difference
            mixed_1.contrast_right = avgcon - jsPsych.currentTrial().difference
            
        },
        on_finish: function (data) {
          data.block = 2
            if (data.response === jsPsych.currentTrial().reward) {
                data.correct = true;
                data.stim = 0;
            } else if (data.response === null) {
                missed.push(1),
                    missed_fb.push(jsPsych.currentTrial().reward),
                    missed_con.push(jsPsych.currentTrial().contrast_left),
                    missed_con1.push(jsPsych.currentTrial().contrast_right)
                    missed_block.push(data.block)
                    missed_contrast.push(data.contrast)
            } else {
                data.correct = false;
                data.stim = 0; // keeps the stim value at 0 because the participant has not missed a trial
            }
            data.contrast = 1
            data.corr_resp = jsPsych.currentTrial().reward // stores the correct response on this trial
            data.contrast_left = jsPsych.currentTrial().contrast_left // stores the contrast level of left patch on this trial
            data.contrast_right = jsPsych.currentTrial().contrast_right // stores the contrast level of right patch on this trial
            data.diff = jsPsych.currentTrial().difference
            trialcounter = trialcounter + 5 // increases the trial counter to include fixation, stimulus and feedback
            index = index + 1;
            data.state = s[jsPsych.currentTrial().index]
            data.reward = jsPsych.currentTrial().a
        }
    };
    
var mu = {
      type: 'canvas-slider-response',
      canvas_size: [300, 500],
      data: {condition: 'mu_congruent'},
      stimulus: gabor_mu,
      //require_movement: true,
      response_ends_trial: true,
      trial_duration: 6000,
      //slider_start: 0,
      labels: ['0%','25%', '50%', '75%', '100%'],
      on_start: function(mu) {
            document.body.style.cursor = "auto";
            mu.contrast_left = avgcon + jsPsych.data.get().last(1).values()[0].difference // calculate the contrast for the left gabor based on this trial's difference
            mu.contrast_right  = avgcon - jsPsych.data.get().last(1).values()[0].difference
      },
      on_load: function(){
	document.querySelector('#jspsych-canvas-slider-response-response').addEventListener('click', function(e){
		e.target.style.visibility = 'show'
	})
	},
      prompt: function () {
        var con_left = avgcon + jsPsych.data.get().last(1).values()[0].difference
        var con_right =  avgcon - jsPsych.data.get().last(1).values()[0].difference
        var trial_contrast = jsPsych.data.get().last(2).values()[0].contrast
        if (trial_contrast === 0) {
          if (con_left > con_right) {
              return " <p> If you choose the image on your right, what do you think is the chance of winning a reward? </p>"
            }
            else {
              return " <p> If you choose the image on your left, what do you think is the chance of winning a reward? </p>"
            }
        }
        else {
          if (con_left > con_right) {
              return " <p> If you choose the image on your left, what do you think is the chance of winning a reward? </p>"
            }
            else {
              return " <p> If you choose the image on your right, what do you think is the chance of winning a reward? </p>"
          }
        }
        },
      on_finish: function (data) {
            data.contrast_left = jsPsych.data.get().last(1).values()[0].contrast_left // stores the contrast level of left patch on this trial
            data.contrast_right = jsPsych.data.get().last(1).values()[0].contrast_right // stores the contrast level of right patch on this trial
            data.diff = jsPsych.data.get().last(1).values()[0].difference
            index_mu = index_mu + 1;
            data.state = s[jsPsych.currentTrial().index_mu]
        }
    };
var mu_1 = {
      type: 'canvas-slider-response',
      canvas_size: [300, 500],
      stimulus: gabor_mu,
      data: {condition: 'mu_incongruent'},
      response_ends_trial: true,
      //require_movement: true,
      //slider_start: 0,
      trial_duration: 6000,
      labels: ['0%','25%', '50%', '75%', '100%'],
      on_start: function(mu_1) {
            document.body.style.cursor = "auto";
            mu_1.contrast_left = avgcon + jsPsych.data.get().last(1).values()[0].difference // calculate the contrast for the left gabor based on this trial's difference
            mu_1.contrast_right  = avgcon - jsPsych.data.get().last(1).values()[0].difference
      },
      on_load: function(){
	      document.querySelector('#jspsych-canvas-slider-response-response').addEventListener('click', function(e){
		    e.target.style.visibility = 'show'})},
      prompt: function () {
        var con_left = avgcon + jsPsych.data.get().last(1).values()[0].difference
        var con_right =  avgcon - jsPsych.data.get().last(1).values()[0].difference
        var trial_contrast = jsPsych.data.get().last(2).values()[0].contrast
        if (trial_contrast === 0) {
          if (con_left > con_right) {
              return " <p> If you choose the image on your left, what do you think is the chance of winning a reward? </p>"
            }
            else {
              return " <p> If you choose the image on your right, what do you think is the chance of winning a reward? </p>"
            }
        }
        else {
          if (con_left > con_right) {
              return " <p> If you choose the image on your right, what do you think is the chance of winning a reward? </p>"
            }
            else {
              return " <p> If you choose the image on your left, what do you think is the chance of winning a reward? </p>"
          }
        }
        },
      on_finish: function (data) {
            data.contrast_left = jsPsych.data.get().last(1).values()[0].contrast_left // stores the contrast level of left patch on this trial
            data.contrast_right = jsPsych.data.get().last(1).values()[0].contrast_right // stores the contrast level of right patch on this trial
            data.diff = jsPsych.data.get().last(1).values()[0].difference
            index_mu = index_mu + 1;
            data.state = s[jsPsych.currentTrial().index_mu]
        }
    };

var trial_perceptual = {timeline: [fix, perceptual, fb, mu, enter_trial], repetitions: 25, randomize_order: false};
var trial_perceptual_1 = {timeline: [fix, perceptual_1, fb, mu, enter_trial], repetitions: 25, randomize_order: false};
var trial_reward = {timeline: [fix, reward, fb, mu, enter_trial], repetitions: 25, randomize_order: false};
var trial_reward_1 = {timeline: [fix, reward_1, fb, mu, enter_trial], repetitions: 25, randomize_order: false};
var trial_mixed = {timeline: [fix, mixed, fb, mu, enter_trial], repetitions: 25, randomize_order: false};
var trial_mixed_1 = {timeline: [fix, mixed_1, fb, mu, enter_trial], repetitions: 25, randomize_order: false};
    
var trial_perceptual_mu_1 = {timeline: [fix, perceptual, fb, mu_1, enter_trial], repetitions: 25, randomize_order: false};
var trial_perceptual_1_mu_1 = {timeline: [fix, perceptual_1, fb, mu_1, enter_trial], repetitions: 25, randomize_order: false};
var trial_reward_mu_1 = {timeline: [fix, reward, fb, mu_1, enter_trial], repetitions: 25, randomize_order: false};
var trial_reward_1_mu_1 = {timeline: [fix, reward_1, fb, mu_1, enter_trial], repetitions: 25, randomize_order: false};
var trial_mixed_mu_1 = {timeline: [fix, mixed, fb, mu_1, enter_trial], repetitions: 25, randomize_order: false};
var trial_mixed_1_mu_1 = {timeline: [fix, mixed_1, fb, mu_1, enter_trial], repetitions: 25, randomize_order: false};

var prac_perc_0 = {timeline: [trial_perceptual, prac_score], repetitions: 1};
var prac_perc_1 = {timeline: [trial_perceptual_1_mu_1, prac_score], repetitions: 1};
var prac_perc_2 = {timeline: [trial_perceptual_1, prac_score], repetitions: 1};
var prac_perc_3 = {timeline: [trial_perceptual_mu_1, prac_score], repetitions: 1};
var prac_rew_0 = {timeline: [trial_reward_mu_1, prac_score], repetitions: 1};
var prac_rew_1 = {timeline: [trial_reward_1, prac_score], repetitions: 1};
var prac_rew_2 = {timeline: [trial_reward_1_mu_1, prac_score], repetitions: 1};
var prac_rew_3 = {timeline: [trial_reward, prac_score], repetitions: 1};
var prac_mix_0 = {timeline: [trial_mixed, prac_score], repetitions: 1};
var prac_mix_1 = {timeline: [trial_mixed_1_mu_1, prac_score], repetitions: 1};
var prac_mix_2 = {timeline: [trial_mixed_1, prac_score], repetitions: 1};
var prac_mix_3 = {timeline: [trial_mixed_mu_1, prac_score], repetitions: 1};

var prac_perc_array = jsPsych.randomization.shuffle([prac_perc_0, prac_perc_1, prac_perc_2, prac_perc_3]);
var prac_rew_array = jsPsych.randomization.shuffle([prac_rew_0, prac_rew_1, prac_rew_2, prac_rew_3]);
var prac_mix_array = jsPsych.randomization.shuffle([prac_mix_0, prac_mix_1, prac_mix_2, prac_mix_3]);

var prac_perc_trial = prac_perc_array[prac_rand];
var prac_rew_trial = prac_rew_array[prac_rand];
var prac_mix_trial = prac_mix_array[prac_rand];

timeline.push(prac_block)
timeline.push(prac_perc_trial)
timeline.push(nextblock)
timeline.push(prac_rew_trial)
timeline.push(nextblock)
timeline.push(prac_mix_trial)

jsPsych.init({
        timeline: timeline,
    });
</script>
</html>
